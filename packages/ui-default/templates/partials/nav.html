{%- macro nav_item(item) -%}
<li class="nav__list-item">
  <a href="{{ url(item.name, item.args, query=item.args.query(handler) if typeof(item.args.query) == 'function' else item.args.query or {}) }}" class="nav__item{% if page_name.startsWith(item.args.prefix) %} nav--active{% endif %}" style="color:#FFF">
    {{ _(item.displayName or item.name) }}
  </a>
</li>
{%- endmacro -%}

{{ set(UiContext, 'userID', handler.user._id) }}
{{ set(UiContext, 'username', handler.user.uname) }}


<header class="page-header">
  <div class="w header">
      <img src="{{ UiContext.cdn_prefix }}img/logo.png" id="logo" alt=""/>
    <div class="header-center">
      <ul>
          <li><a href="/discuss" style="color: inherit; text-decoration: none;">告示墙</a></li>
          <li><a href="/"        style="color: inherit; text-decoration: none;">修炼场</a></li>
          <li><a href="/contest" style="color: inherit; text-decoration: none;">竞技场</a></li>
          <li><a href="/ranking" style="color: inherit; text-decoration: none;">封神榜</a></li>
          <li>觉醒台</li>
      </ul>
    </div>
    <div class="header-right">
      <div class="el-input" style="width: 200px; margin-right: 30px;">
        <input type="text" autocomplete="off" placeholder="请输入内容" class="el-input__inner">
      </div>
      {% if not handler.user.hasPriv(PRIV.PRIV_USER_PROFILE) %}
      <div class="nav-sign-up">
        <a class="login-btn" href="{{ url('user_login') }}">
          <span>{{ _('Login') }}</span>
        </a>
        {% if handler.user.hasPriv(PRIV.PRIV_REGISTER_USER) %}
        <a class="register-btn" href="{{ url('user_register_all') }}">
          <span>{{ _('Sign Up') }}</span>
        </a>
        {% endif %}
      </div>
      {% else %}
      <div id="avatar-react-root" class="Avatar">
        <img
          src="{{ UiContext.cdn_prefix }}img/avatar.png"
          alt=""
          style="width: 40px; height: 40px"
        />
      </div>
      {# <div>
        <a href="{{ url('user_detail', uid=handler.user._id) }}" class="nav__item">
          {{ handler.user.uname }} 
        </a>
        <a href="{{ url('user_logout') }}" class="menu__link" name="nav_logout">
          <span class="icon icon-logout"></span> {{ _('Logout') }}
        </a>
      </div> #}
      {% endif %}

    </div>
  </div>

</header>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 获取当前页面的路径
    const currentPath = window.location.pathname;

    // 获取所有li元素
    const listItems = document.querySelectorAll('ul li');

    // 遍历每个li元素
    listItems.forEach(li => {
        // 获取li元素中a标签的href属性
        const aTag = li.querySelector('a');

        // 确保a标签存在
        if (aTag) {
            const href = li.querySelector('a').getAttribute('href');

            // 检查href是否与当前路径匹配
            if (href === currentPath) {
                // 添加liActive类
                li.classList.add('liActive');
            }
        }
    });
});
</script>
